trigger: none

pr:
  branches:
    include:
    - main
  paths:
    include:
    - src/coreclr/ilasm/*
    - src/coreclr/ildasm/*
    - src/tools/ilasm/*
    - src/tools/ildasm/*

schedules:
- cron: "0 19 * * 6"
  displayName: Sat at 11:00 AM (UTC-8:00)
  branches:
    include:
    - main
  always: true

variables:
  - template: /eng/pipelines/common/variables.yml
  - template: /eng/pipelines/helix-platforms.yml

extends:
  template:  /eng/pipelines/coreclr/templates/jit-outerloop-pipeline.yml
  parameters:
    platforms:
    - osx_arm64
    - osx_x64
    - linux_arm
    - linux_arm64
    - linux_x64
    - windows_x64
    - windows_x86
    - windows_arm64
    testGroup: ilasm

    stages:
      - stage: Managed_ILAsm
        displayName: Managed IL Assembler Tests
        dependsOn: []
        jobs:
          - template: /eng/pipelines/common/platform-matrix.yml
            parameters:
              jobTemplate: /eng/pipelines/common/global-build-job.yml
              buildConfig: Debug
              platforms:
              - windows_x64
              jobParameters:
                nameSuffix: ILAsm
                buildArgs: -s tools.ilasm -c $(_BuildConfig) -test
                timeoutInMinutes: 120
        condition: and(succeeded(), ne(variables['Build.Reason'], 'Schedule'))
