parameters:
  name: ''
  platform: ''
  pool: ''

jobs:
- template: base-job.yml
  parameters:
    ${{ insert }}: ${{ parameters }}
    strategy:
      matrix:
        debug:
          _BuildConfig: Debug
        release:
          _BuildConfig: Release
    variables:
      CommonMSBuildArgs: >-
        /p:Configuration=$(_BuildConfig)
        /p:PortableBuild=true

    buildSteps:

    - script: >-
        $(Build.SourcesDirectory)/installer.sh --restore --build --ci --test
        /p:OfficialBuildId=$(Build.BuildNumber)
        /p:StripSymbols=true
        $(CommonMSBuildArgs)
      displayName: Build
      condition: succeeded()
