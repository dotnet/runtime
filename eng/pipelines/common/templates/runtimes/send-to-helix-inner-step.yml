parameters:
  restoreParams: ""
  sendParams: ""
  helixParameters: {}

steps:
- ${{ if eq(parameters.helixParameters.osGroup, 'Windows_NT') }}:
  # TODO: Remove and consolidate this when we move to arcade via init-tools.cmd.
  - powershell: $(Build.SourcesDirectory)\eng\common\build.ps1 ${{ parameters.restoreParams }}
    displayName: Restore blob feed tasks
    condition: ${{ parameters.helixParameters.condition }}

  - powershell: eng\common\msbuild.ps1 -ci ${{ parameters.sendParams }}
    displayName: ${{ parameters.displayName }}
    ${{ insert }}: ${{ parameters.helixParameters }}

- ${{ if ne(parameters.helixParameters.osGroup, 'Windows_NT') }}:
  # TODO: Remove and consolidate this when we move to arcade via init-tools.sh.
  - script: $(Build.SourcesDirectory)/eng/common/build.sh ${{ parameters.restoreParams }}
    displayName: Restore blob feed tasks
    condition: ${{ parameters.helixParameters.condition }}
    ${{ if eq(parameters.helixParameters.osGroup, 'FreeBSD') }}:
      env:
        # Arcade uses this SDK instead of trying to restore one.
        DotNetCoreSdkDir: /usr/local/dotnet

  - script: $(Build.SourcesDirectory)/eng/common/msbuild.sh --ci ${{ parameters.sendParams }}
    displayName: ${{ parameters.displayName }}
    ${{ insert }}: ${{ parameters.helixParameters }}
