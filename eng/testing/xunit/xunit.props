<Project>
  <PropertyGroup>
    <!-- Microsoft.Net.Test.Sdk brings a lot of satellite assemblies in. -->
    <SatelliteResourceLanguages>en</SatelliteResourceLanguages>
    <TestRunnerConfigPath>$(MSBuildThisFileDirectory)xunit.runner.json</TestRunnerConfigPath>
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Condition="'$(IncludeRemoteExecutor)' == 'true'" Include="Microsoft.DotNet.RemoteExecutor" Version="$(MicrosoftDotNetRemoteExecutorVersion)" />

    <!-- Excluding xunit.core/build as it enables deps file generation. -->
    <PackageReference Include="xunit" Version="$(XUnitVersion)" ExcludeAssets="build" />
    <PackageReference Include="Microsoft.DotNet.XUnitExtensions" Version="$(MicrosoftDotNetXUnitExtensionsVersion)" />
  </ItemGroup>

  <ItemGroup Condition="'$(ArchiveTests)' != 'true'">
    <!-- Microsoft.Net.Test.Sdk brings a lot of assemblies with it. To reduce helix payload submission size we disable it on CI. -->
    <PackageReference Include="Microsoft.NET.Test.Sdk" Version="$(MicrosoftNETTestSdkVersion)" />
    <PackageReference Include="xunit.runner.visualstudio" Version="$(XUnitRunnerVisualStudioVersion)" GeneratePathProperty="true" />
    <!--
      Microsoft.Net.Test.Sdk has a dependency on Newtonsoft.Json v9.0.1. We upgrade the dependency version
      with the one used in libraries to have a consistent set of dependency versions. Additionally this works
      around a dupliate type between System.Runtime.Serialization.Formatters and Newtonsoft.Json.
    -->
    <PackageReference Include="Newtonsoft.Json" Version="$(NewtonsoftJsonVersion)" />
    <PackageReference Include="coverlet.collector" Version="$(CoverletCollectorVersion)" />
  </ItemGroup>

  <ItemGroup>
    <None Include="$(TestRunnerConfigPath)"
          CopyToOutputDirectory="PreserveNewest"
          Visible="false" />
  </ItemGroup>

  <!-- Workaround for https://github.com/xunit/xunit/issues/1651 -->
  <Choose>
    <When Condition="'$(ArchiveTests)' != 'true'">
      <ItemGroup Condition="'$(TargetFrameworkIdentifier)' == '.NETFramework'">
        <None Remove="$(Pkgxunit_runner_visualstudio)\build\net452\xunit.runner.utility.net452.dll" />
        <None Remove="$(Pkgxunit_runner_visualstudio)\build\net452\xunit.runner.reporters.net452.dll" />
      </ItemGroup>
      <ItemGroup Condition="'$(TargetFrameworkIdentifier)' == '.NETCoreApp'">
        <None Remove="$(Pkgxunit_runner_visualstudio)\build\netcoreapp2.1\xunit.runner.utility.netcoreapp10.dll" />
        <None Remove="$(Pkgxunit_runner_visualstudio)\build\netcoreapp2.1\xunit.runner.reporters.netcoreapp10.dll" />
      </ItemGroup>
    </When>
  </Choose>
</Project>
