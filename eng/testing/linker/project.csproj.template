<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <OutputType>Exe</OutputType>
    <TargetFramework>{NetCoreAppCurrent}</TargetFramework>
    <RuntimeIdentifier>{RuntimeIdentifier}</RuntimeIdentifier>
    <RuntimePackDir>{RuntimePackDir}</RuntimePackDir>
    <TargetingPackDir>{TargetingPackDir}</TargetingPackDir>
    <NETCoreAppMaximumVersion>6.0</NETCoreAppMaximumVersion>

    <!-- These can be removed once we get an SDK with https://github.com/mono/linker/pull/1385. -->
    <LinkerNoWarn>IL2026</LinkerNoWarn>
    <!-- IL2032,IL2055,IL2057-IL2061: Reflection intrinsics with unknown arguments -->
    <LinkerNoWarn>$(LinkerNoWarn);IL2032;IL2055;IL2057;IL2058;IL2059;IL2060;IL2061</LinkerNoWarn>
    <!-- IL2062-IL2066: Unknown values passed to locations with DynamicallyAccessedMemberTypes -->
    <LinkerNoWarn>$(LinkerNoWarn);IL2062;IL2063;IL2064;IL2065;IL2066</LinkerNoWarn>
    <!-- IL2067-IL2091: Unsatisfied DynamicallyAccessedMembers requirements -->
    <LinkerNoWarn>$(LinkerNoWarn);IL2067;IL2068;IL2069;IL2070;IL2071;IL2072;IL2073;IL2074;IL2075;IL2076;IL2077;IL2078;IL2079;IL2080;IL2081;IL2082;IL2083;IL2084;IL2085;IL2086;IL2087;IL2088;IL2089;IL2090;IL2091</LinkerNoWarn>
    <!-- https://github.com/dotnet/runtime/issues/40336 - need to suppress IL2008;IL2009;IL2037 on non-Windows -->
    <LinkerNoWarn Condition="!$(RuntimeIdentifier.StartsWith('win'))">$(LinkerNoWarn);IL2008;IL2009;IL2037</LinkerNoWarn>
    <_ExtraTrimmerArgs>{ExtraTrimmerArgs} $(_ExtraTrimmerArgs) --nowarn $(LinkerNoWarn)</_ExtraTrimmerArgs>
  </PropertyGroup>

  <ItemGroup>
    {AdditionalProjectReferences}
  </ItemGroup>

  <!-- Logic to override the default IlLink tasks that come from the SDK and use the one
  we use in dotnet/runtime repo -->

  <PropertyGroup>
    <_ILLinkTasksDirectoryRoot>$(PkgMicrosoft_NET_ILLink_Tasks)\tools\</_ILLinkTasksDirectoryRoot>
    <_ILLinkTasksTFM>net5.0</_ILLinkTasksTFM>
    <_ILLinkTasksDirectory>$(_ILLinkTasksDirectoryRoot)$(_ILLinkTasksTFM)\</_ILLinkTasksDirectory>
    <ILLinkTasksAssembly>$(_ILLinkTasksDirectory)ILLink.Tasks.dll</ILLinkTasksAssembly>
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Include="Microsoft.NET.ILLink.Tasks"
                      Version="{MicrosoftNETILLinkTasksVersion}"
                      PrivateAssets="all"
                      IsImplicitlyDefined="true"
                      ExcludeAssets="build"
                      GeneratePathProperty="true" />
  </ItemGroup>

  <ItemGroup>
    <KnownFrameworkReference Include="Microsoft.NETCore.App"
      DefaultRuntimeFrameworkVersion="5.0.0-rc.1.20451.14"
      IsTrimmable="true"
      LatestRuntimeFrameworkVersion="5.0.0-rc.1.20451.14"
      RuntimeFrameworkName="Microsoft.NETCore.App"
      RuntimePackNamePatterns="Microsoft.NETCore.App.Runtime.**RID**"
      RuntimePackRuntimeIdentifiers="linux-arm;linux-arm64;linux-musl-arm64;linux-musl-x64;linux-x64;osx-x64;rhel.6-x64;tizen.4.0.0-armel;tizen.5.0.0-armel;win-arm;win-arm64;win-x64;win-x86;ios-arm64;ios-arm;ios-x64;ios-x86;tvos-arm64;tvos-x64;android-arm64;android-arm;android-x64;android-x86;browser-wasm"
      TargetFramework="net6.0"
      TargetingPackName="Microsoft.NETCore.App.Ref"
      TargetingPackVersion="5.0.0-rc.1.20451.14" />

    <KnownAppHostPack Include="Microsoft.NETCore.App" 
      AppHostPackNamePattern="Microsoft.NETCore.App.Host.**RID**"
      AppHostPackVersion="5.0.0-rc.1.20451.14"
      AppHostRuntimeIdentifiers="linux-arm;linux-arm64;linux-musl-arm64;linux-musl-x64;linux-x64;osx-x64;rhel.6-x64;tizen.4.0.0-armel;tizen.5.0.0-armel;win-arm;win-arm64;win-x64;win-x86"
      TargetFramework="net6.0" />
  </ItemGroup>

</Project>
