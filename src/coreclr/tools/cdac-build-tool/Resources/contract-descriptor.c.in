// Licensed to the .NET Foundation under one or more agreements.
// The .NET Foundation licenses this file to you under the MIT license.

#include <stdint.h>

#ifdef _MSC_VER
#define DLLEXPORT __declspec(dllexport)
#else
#define DLLEXPORT __attribute__((visibility("default")))
#endif

struct DotNetRuntimeContractDescriptor
{
    uint64_t magic;
    uint32_t flags;
    const uint32_t descriptor_size;
    const char *descriptor;
    const uint32_t aux_data_count;
    uint32_t pad0;
    const uintptr_t *aux_data;
};

extern const uintptr_t contractDescriptorAuxData[];

DLLEXPORT struct DotNetRuntimeContractDescriptor DotNetRuntimeContractDescriptor;

DLLEXPORT struct DotNetRuntimeContractDescriptor DotNetRuntimeContractDescriptor = {
    .magic = 0x0043414443434e44ull, // "DNCCDAC\0"
    .flags = 0x00000001, // FIXME: generate
    .descriptor_size = %%jsonDescriptorSize%%,
    .descriptor = "%%jsonDescriptor%%",
    .aux_data_count = %%auxDataCount%%,
    .aux_data = &contractDescriptorAuxData[0],
};
