<Project Sdk="Microsoft.NET.Sdk" ToolsVersion="Current">
  <PropertyGroup>
    <OutputType>exe</OutputType>
    <CLRTestKind>BuildAndRun</CLRTestKind>
    <CLRTestPriority>0</CLRTestPriority>
    <!-- Crossgen2 currently targets only x64 -->
    <DisableProjectBuild Condition="'$(Platform)' != 'x64'">true</DisableProjectBuild>
    <!-- Known not to work with GCStress for now: https://github.com/dotnet/coreclr/issues/26633 -->
    <GCStressIncompatible>true</GCStressIncompatible>
    <!-- This is an explicit crossgen test -->
    <CrossGenTest>false</CrossGenTest>
    <OldToolsVersion>2.0</OldToolsVersion>
  </PropertyGroup>
  <ItemGroup>
    <Compile Include="Program.cs" />
  </ItemGroup>
  <PropertyGroup>
    <CLRTestBatchPreCommands>
  <![CDATA[
$(CLRTestBatchPreCommands)
set CoreRT_DeterminismSeed=1
mkdir seed1
%CORE_ROOT%\ReadyToRun.SuperIlc\ReadyToRun.SuperIlc.exe compile-directory -cr %CORE_ROOT% -in %CORE_ROOT% --nojit --noexe --large-bubble --release --nocleanup -out seed1

set CoreRT_DeterminismSeed=2
mkdir seed2
%CORE_ROOT%\ReadyToRun.SuperIlc\ReadyToRun.SuperIlc.exe compile-directory -cr %CORE_ROOT% -in %CORE_ROOT% --nojit --noexe --large-bubble --release --nocleanup -out seed2

]]></CLRTestBatchPreCommands>
    <BashCLRTestPreCommands>
  <![CDATA[
$(BashCLRTestPreCommands)
export CoreRT_DeterminismSeed=1
mkdir seed1
$CORE_ROOT/ReadyToRun.SuperIlc/ReadyToRun.SuperIlc.exe compile-directory -cr $CORE_ROOT -in $CORE_ROOT --nojit --noexe --large-bubble --release --nocleanup -out seed1

export CoreRT_DeterminismSeed=2
mkdir seed2
$CORE_ROOT/ReadyToRun.SuperIlc/ReadyToRun.SuperIlc.exe compile-directory -cr $CORE_ROOT -in $CORE_ROOT --nojit --noexe --large-bubble --release --nocleanup -out seed2

]]></BashCLRTestPreCommands>
  </PropertyGroup>
</Project>
