<Project>
  <UsingTask TaskName="ComputeDeltaFileOutputNames" AssemblyFile="$(_generateHotReloadDeltaBuildTasks)" />

  <!-- Don't invoke hotreload-delta-gen, but compute the names of the artifacts that it would have produced. -->
  <Target Name="ComputeDeltaFileOutputNames" Condition="'$(DeltaScript)' != ''">
    <ComputeDeltaFileOutputNames BaseAssemblyName="$(TargetPath)" DeltaScript="$(DeltaScript)">
      <Output TaskParameter="DeltaOutputs" ItemName="_DeltaFileForAssignTargetPaths" />
    </ComputeDeltaFileOutputNames>
  </Target>

  <!-- Compute the names of the artifacts hotreload-delta-gen would have produced and use them to add Content items for
       the current project.  This ensures that a ProjectReference to the current project will get copies of the
       generated deltas.
  -->
  <Target Name="ContentForDeltaFileOutputNames"
    DependsOnTargets="ComputeDeltaFileOutputNames"
    BeforeTargets="AssignTargetPaths"
    Condition="'$(DesignTimeBuild)' != 'true'"
    >
    <ItemGroup>
      <Content Include="@(_DeltaFileForAssignTargetPaths)">
        <CopyToOutputDirectory>always</CopyToOutputDirectory>
      </Content>
    </ItemGroup>
  </Target>

</Project>
