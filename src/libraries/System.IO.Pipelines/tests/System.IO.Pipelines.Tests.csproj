<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <AllowUnsafeBlocks>true</AllowUnsafeBlocks>
    <TargetFrameworks>$(NetCoreAppCurrent);net461</TargetFrameworks>
  </PropertyGroup>
  <ItemGroup>
    <Compile Include="Infrastructure\HeapBufferPool.cs" />
    <Compile Include="Infrastructure\DisposeTrackingBufferPool.cs" />
    <Compile Include="Infrastructure\ReadOnlyStream.cs" />
    <Compile Include="Infrastructure\WriteCheckStream.cs" />
    <Compile Include="Infrastructure\WriteOnlyStream.cs" />
    <Compile Include="Infrastructure\CancelledWritesStream.cs" />
    <Compile Include="Infrastructure\CancelledReadsStream.cs" />
    <Compile Include="BackpressureTests.cs" />
    <Compile Include="Infrastructure\ObserveDisposeStream.cs" />
    <Compile Include="PipeReaderCopyToAsyncTests.cs" />
    <Compile Include="FlushAsyncCancellationTests.cs" />
    <Compile Include="FlushAsyncCompletionTests.cs" />
    <Compile Include="FlushAsyncTests.cs" />
    <Compile Include="FlushResultTests.cs" />
    <Compile Include="PipeCompletionCallbacksTests.cs" />
    <Compile Include="PipeOptionsTests.cs" />
    <Compile Include="PipeReaderWriterFacts.cs" />
    <Compile Include="PipePoolTests.cs" />
    <Compile Include="PipeResetTests.cs" />
    <Compile Include="PipeTest.cs" />
    <Compile Include="PipeWriterCopyToAsyncTests.cs" />
    <Compile Include="PipeWriterTests.cs" />
    <Compile Include="ReadAsyncCancellationTests.cs" />
    <Compile Include="ReadAsyncCompletionTests.cs" />
    <Compile Include="ReadResultTests.cs" />
    <Compile Include="SchedulerFacts.cs" />
    <Compile Include="StreamPipeReaderTests.cs" />
    <Compile Include="Infrastructure\TestMemoryPool.cs" />
    <Compile Include="StreamPipeWriterTests.cs" />
    <Compile Include="Infrastructure\ThrowAfterNWritesStream.cs" />
  </ItemGroup>
  <ItemGroup Condition="'$(TargetFramework)' == '$(NetCoreAppCurrent)'">
    <Compile Include="PipeLengthTests.cs" />
    <Compile Include="BufferSegmentPoolTest.cs" />
    <Compile Include="PipeReaderWriterFacts.nonnetstandard.cs" />
    <Compile Include="PipeResetTests.nonnetstandard.cs" />
    <Compile Include="PipePoolTests.nonnetstandard.cs" />
    <Compile Include="PipeWriterStreamTests.nonnetstandard.cs" />
    <Compile Include="PipeReaderStreamTests.nonnetstandard.cs" />
    <Compile Include="PipeReaderWriterStreamTests.nonnetstandard.cs" />
    <Compile Include="$(CommonTestPath)Tests\System\IO\StreamConformanceTests.cs" Link="Common\System\IO\StreamConformanceTests.cs" />
    <Compile Include="$(CommonTestPath)System\IO\ConnectedStreams.cs" Link="Common\System\IO\ConnectedStreams.cs" />
    <Compile Include="$(CommonPath)System\Net\ArrayBuffer.cs" Link="ProductionCode\Common\System\Net\ArrayBuffer.cs" />
    <Compile Include="$(CommonPath)System\Net\MultiArrayBuffer.cs" Link="ProductionCode\Common\System\Net\MultiArrayBuffer.cs" />
    <Compile Include="$(CommonPath)System\Net\StreamBuffer.cs" Link="ProductionCode\Common\System\Net\StreamBuffer.cs" />
    <Compile Include="$(CommonTestPath)System\IO\CallTrackingStream.cs" Link="Common\System\IO\CallTrackingStream.cs" />
  </ItemGroup>
  <ItemGroup Condition="'$(TargetFramework)' == '$(NetCoreAppCurrent)'">
    <!-- Some internal types are needed, so we reference the implementation assembly, rather than the reference assembly. -->
    <ProjectReference Include="..\src\System.IO.Pipelines.csproj" SkipUseReferenceAssembly="true" />
  </ItemGroup>
  <ItemGroup Condition="'$(TargetFramework)' == 'net461'">
    <ProjectReference Include="..\src\System.IO.Pipelines.csproj" />
  </ItemGroup>
</Project>