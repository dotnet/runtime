;**************************************************************************************************
;*Case Data Format:                                                                               *
;*     isContainer -- true/false                                                                  *
;*     isDS -- true/false                                                                         *
;*     auditFlags -- None (0), Success(1), Fail(2)                                                *
;*     securityIdentifier -- string                                                               *
;*     accessMask -- int                                                                          *
;*     inheritanceFlags -- None (0), ContainerInherit(1), ObjectInherit(2)                        *
;*     propagationFlags -- None (0), NoPropagateInherit(1), InheritOnly(2)                        *                                               *
;*     initialRawAclStr -- string                                                                 *
;*     verifierRawAclStr -- string                                                                *                                                       *
;*                                                                                                *
;*     RawAcl String Format:                                                                      *
;*              RawAcl := ACE[#ACE]                                                               *
;*              ACE := aceFlags:aceQualifier:accessMask:sid:isCallback:opaqSize                   *
;**************************************************************************************************
[TestCase]
;
;case1: 
;SystemAcl has one Ace, add a non compatible one (sid not match)
;
true
false
1
SY
1
0
0
64:2:1:BA:false:0
64:2:1:SY:false:0#64:2:1:BA:false:0

[TestCase]
;
;case2: 
;SystemAcl has one Ace, add a non compatible one (existing one is inherited)
;
true
false
1
BA
1
0
0
80:2:1:BA:false:0
64:2:1:BA:false:0#80:2:1:BA:false:0

[TestCase]
;
;case3: 
;SystemAcl has one Ace, add a non compatible one (neither AceFlags nor accessMask match)
;
;
;FA | OI | IO = 137
;
true
false
2
BA
2
2
2
64:2:1:BA:false:0
64:2:1:BA:false:0#137:2:2:BA:false:0

[TestCase]
;
;case4: 
;SystemAcl has one Ace, add a compatible one with same sid, aceFlags, merge accessmask
;
false
false
1
SY
2
0
0
64:2:1:SY:false:0
64:2:3:SY:false:0

[TestCase]
;
;case5: 
;SystemAcl has one Ace, add a compatible one with same sid, accessmask and inheritanceFlags, merge the AuditFlag
;
;SA | FA = 192
;
true
false
2
BA
1
0
0
64:2:1:BA:false:0
192:2:1:BA:false:0

[TestCase]
;
;case 6(base): 
;SystemAcl has one Ace, add a compatible one with same sid, audiFlags, accessmask, 
;inheritanceFlags are compatible, merge inheritanceFlags
;
;SA | OI | NP -- 69
;
true
false
1
SY
1
0
0
69:2:1:SY:false:0
69:2:1:SY:false:0

;[TestCase]
;
;bug fix for 288116,InheritanceFlags None but PropagationFlags not None is meaningless ACE on Container, case 7 - 9
;are not valid. They are moved to addtionaltestcases part.
;case7: 
;SystemAcl has one Ace, add a compatible one with same sid, audiFlags, accessmask, 
;inheritanceFlags are compatible, merge inheritanceFlags
;
;SA | OI | NP -- 69
;
;true
;false
;1
;SY
;1
;0
;1
;69:2:1:SY:false:0
;69:2:1:SY:false:0

;[TestCase]
;
;case8: 
;SystemAcl has one Ace, add a compatible one with same sid, audiFlags, accessmask, 
;inheritanceFlags are compatible, merge inheritanceFlags
;
;SA | OI | NP -- 69
;
;true
;false
;1
;SY
;1
;0
;2
;69:2:1:SY:false:0
;69:2:1:SY:false:0

;[TestCase]
;
;case9: 
;SystemAcl has one Ace, add a compatible one with same sid, audiFlags, accessmask, 
;inheritanceFlags are compatible, merge inheritanceFlags
;
;SA | OI | NP -- 69
;
;true
;false
;1
;SY
;1
;0
;3
;69:2:1:SY:false:0
;69:2:1:SY:false:0

[TestCase]
;
;case10: 
;SystemAcl has one Ace, add a compatible one with same sid, audiFlags, accessmask, 
;inheritanceFlags are not compatible, no merge inheritanceFlags
;
;SA | OI | NP -- 69
;SA | CI -- 66
true
false
1
SY
1
1
0
69:2:1:SY:false:0
69:2:1:SY:false:0#66:2:1:SY:false:0


[TestCase]
;
;case11: 
;SystemAcl has one Ace, add a compatible one with same sid, audiFlags, accessmask, 
;inheritanceFlags are compatible, merge inheritanceFlags
;
;SA | OI | NP -- 69
;SA | CI | OI -- 71
true
false
1
SY
1
1
1
69:2:1:SY:false:0
71:2:1:SY:false:0

[TestCase]
;
;case12: 
;SystemAcl has one Ace, add a compatible one with same sid, audiFlags, accessmask, 
;inheritanceFlags are not compatible, no merge inheritanceFlags
;
;SA | OI | NP -- 69
;SA | CI | IO -- 74
;
true
false
1
SY
1
1
2
69:2:1:SY:false:0
69:2:1:SY:false:0#74:2:1:SY:false:0

[TestCase]
;
;case13: 
;SystemAcl has one Ace, add a compatible one with same sid, audiFlags, accessmask, 
;inheritanceFlags are compatible, merge inheritanceFlags
;
;SA | OI | NP -- 69
;SA | CI | OI | NP -- 71
;
true
false
1
SY
1
1
3
69:2:1:SY:false:0
71:2:1:SY:false:0

[TestCase]
;
;case14: 
;SystemAcl has one Ace, add a compatible one with same sid, audiFlags, accessmask, 
;inheritanceFlags are compatible, merge inheritanceFlags
;
;SA | OI | NP -- 69
;SA | OI -- 65
;
true
false
1
SY
1
2
0
69:2:1:SY:false:0
65:2:1:SY:false:0

[TestCase]
;
;case15: 
;SystemAcl has one Ace, add a compatible one with same sid, audiFlags, accessmask, 
;inheritanceFlags are compatible, merge inheritanceFlags
;
;SA | OI | NP -- 69
;
true
false
1
SY
1
2
1
69:2:1:SY:false:0
69:2:1:SY:false:0

[TestCase]
;
;case16: 
;SystemAcl has one Ace, add a compatible one with same sid, audiFlags, accessmask, 
;inheritanceFlags are compatible, merge inheritanceFlags
;
;SA | OI | NP -- 69
;SA | OI -- 65
;
true
false
1
SY
1
2
2
69:2:1:SY:false:0
65:2:1:SY:false:0

[TestCase]
;
;case17: 
;SystemAcl has one Ace, add a compatible one with same sid, audiFlags, accessmask, 
;inheritanceFlags are compatible, merge inheritanceFlags
;
;SA | OI | NP -- 69
;
true
false
1
SY
1
2
3
69:2:1:SY:false:0
69:2:1:SY:false:0

[TestCase]
;
;case18: 
;SystemAcl has one Ace, add a compatible one with same sid, audiFlags, accessmask, 
;inheritanceFlags are compatible, merge inheritanceFlags
;
;SA | OI | NP -- 69
;SA | CI | OI -- 67
;
true
false
1
SY
1
3
0
69:2:1:SY:false:0
67:2:1:SY:false:0

[TestCase]
;
;case19: 
;SystemAcl has one Ace, add a compatible one with same sid, audiFlags, accessmask, 
;inheritanceFlags are compatible, merge inheritanceFlags
;
;SA | OI | NP -- 69
;SA | CI | OI | NP -- 71
;
true
false
1
SY
1
3
1
69:2:1:SY:false:0
71:2:1:SY:false:0

[TestCase]
;
;case20: 
;SystemAcl has one Ace, add a compatible one with same sid, audiFlags, accessmask, 
;inheritanceFlags are compatible, merge inheritanceFlags
;
;SA | OI | NP -- 69
;SA | CI | OI -- 67
;
true
false
1
SY
1
3
2
69:2:1:SY:false:0
67:2:1:SY:false:0

[TestCase]
;
;case21: 
;SystemAcl has one Ace, add a compatible one with same sid, audiFlags, accessmask, 
;inheritanceFlags are compatible, merge inheritanceFlags
;
;SA | OI | NP -- 69
;SA | CI | OI | NP -- 71
;
true
false
1
SY
1
3
3
69:2:1:SY:false:0
71:2:1:SY:false:0

[TestCase]
;
;case22: 
;SystemAcl has more than one Ace, compatible Ace at the right end of the array
;add a compatible one with same sid, audiFlags, accessmask, 
;inheritanceFlags are compatible, merge inheritanceFlags
;
;SA | OI | NP -- 69
;SA | CI | OI | NP -- 71
;
true
false
1
BO
1
3
3
69:2:1:BA:false:0#69:2:1:BG:false:0#69:2:1:BO:false:0
69:2:1:BA:false:0#69:2:1:BG:false:0#71:2:1:BO:false:0

[TestCase]
;
;case23: 
;SystemAcl has more than one Ace, compatible Ace at the middle of the array
;add a compatible one with same sid, audiFlags, accessmask, 
;inheritanceFlags are compatible, merge inheritanceFlags
;
;SA | OI | NP -- 69
;SA | CI | OI | NP -- 71
;
true
false
1
BG
1
3
3
69:2:1:BA:false:0#69:2:1:BG:false:0#69:2:1:BO:false:0
69:2:1:BA:false:0#71:2:1:BG:false:0#69:2:1:BO:false:0


[TestCase]
;
;case24: 
;SystemAcl has one Ace, add a compatible one with same sid, audiFlags, accessmask, 
;inheritanceFlags are compatible, merge inheritanceFlags
;
;SA | OI | IO -- 73
;SA | OI -- 65
;
true
false
1
SY
1
0
0
73:2:1:SY:false:0
65:2:1:SY:false:0

[TestCase]
;
;case25: 
;SystemAcl has one Ace, add a compatible one with same sid, audiFlags, accessmask, inheritanceFlags
;actually they are the same the dup gets dropped
;
;SA | CI | NP -- 70
;
true
false
1
BA
1
1
1
70:2:1:BA:false:0
70:2:1:BA:false:0

[TestCase]
;
;case26: 
;SystemAcl has one Ace, add a compatible one with same sid, audiFlags, accessmask, 
;inheritanceFlags are not compatible, not merge inheritanceFlags
;
;SA | OI | IO -- 73
;SA | CI | NP -- 70
;
true
false
1
SY
1
1
1
73:2:1:SY:false:0
73:2:1:SY:false:0#70:2:1:SY:false:0


