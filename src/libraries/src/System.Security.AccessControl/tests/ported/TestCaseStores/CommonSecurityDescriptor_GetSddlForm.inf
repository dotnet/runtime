;*************************************************************************************************
;16 cases, owner, group, sacl, dacl all exist, and saclpresent and daclpresent control flags are on
[TestCase]
;none is request
true
false
20
BA
BG
64:2:4096:BA:false:0
0:1:4096:BO:false:0
false
false
false
false
;empty sddl form string, as no component of SD is requested


[TestCase]
;dacl is request
true
false
20
BA
BG
64:2:4096:BA:false:0
0:1:4096:BO:false:0
false
false
false
true
D:(D;;0x1000;;;BO)

[TestCase]
;sacl is request
true
false
20
BA
BG
64:2:4096:BA:false:0
0:1:4096:BO:false:0
false
false
true
false
S:(AU;SA;0x1000;;;BA)


[TestCase]
;dacl and sacl are request
true
false
20
BA
BG
64:2:4096:BA:false:0
0:1:4096:BO:false:0
false
false
true
true
D:(D;;0x1000;;;BO)S:(AU;SA;0x1000;;;BA)


[TestCase]
;group is request
true
false
20
BA
BG
64:2:4096:BA:false:0
0:1:4096:BO:false:0
false
true
false
false
G:BG

[TestCase]
;group and dacl are request
true
false
20
BA
BG
64:2:4096:BA:false:0
0:1:4096:BO:false:0
false
true
false
true
G:BGD:(D;;0x1000;;;BO)

[TestCase]
;group and sacl are request
true
false
20
BA
BG
64:2:4096:BA:false:0
0:1:4096:BO:false:0
false
true
true
false
G:BGS:(AU;SA;0x1000;;;BA)

[TestCase]
;group, dacl and sacl are request
true
false
20
BA
BG
64:2:4096:BA:false:0
0:1:4096:BO:false:0
false
true
true
true
G:BGD:(D;;0x1000;;;BO)S:(AU;SA;0x1000;;;BA)

[TestCase]
;owner is request
true
false
20
BA
BG
64:2:4096:BA:false:0
0:1:4096:BO:false:0
true
false
false
false
O:BA

[TestCase]
;owner and dacl are request
true
false
20
BA
BG
64:2:4096:BA:false:0
0:1:4096:BO:false:0
true
false
false
true
O:BAD:(D;;0x1000;;;BO)

[TestCase]
;owner and sacl are request
true
false
20
BA
BG
64:2:4096:BA:false:0
0:1:4096:BO:false:0
true
false
true
false
O:BAS:(AU;SA;0x1000;;;BA)

[TestCase]
;owner, dacl and sacl are request
true
false
20
BA
BG
64:2:4096:BA:false:0
0:1:4096:BO:false:0
true
false
true
true
O:BAD:(D;;0x1000;;;BO)S:(AU;SA;0x1000;;;BA)

[TestCase]
;owner, group are request
true
false
20
BA
BG
64:2:4096:BA:false:0
0:1:4096:BO:false:0
true
true
false
false
O:BAG:BG

[TestCase]
;owner, group, dacl are request
true
false
20
BA
BG
64:2:4096:BA:false:0
0:1:4096:BO:false:0
true
true
false
true
O:BAG:BGD:(D;;0x1000;;;BO)

[TestCase]
;owner, group, sacl are request
true
false
20
BA
BG
64:2:4096:BA:false:0
0:1:4096:BO:false:0
true
true
true
false
O:BAG:BGS:(AU;SA;0x1000;;;BA)

[TestCase]
;owner, group, dacl and sacl are request
true
false
20
BA
BG
64:2:4096:BA:false:0
0:1:4096:BO:false:0
true
true
true
true
O:BAG:BGD:(D;;0x1000;;;BO)S:(AU;SA;0x1000;;;BA)

;*************************************************************************************************
;1 case, all compoents are null
[TestCase]
;owner, group, dacl and sacl are request
true
false
0
null
null
null
null
true
true
true
true
;CommonSecurityDescriptor will create a Dacl w Allow EveryOne Everything Ace in the case of null Dacl after final null Dacl fix
;but it will not show in sddl form, so we expect empty string
;D:(A;OICI;0xffffffff;;;WD)

;*************************************************************************************************
;3 cases for sacl and sacl present flag combination, 
[TestCase]
;sacl present flag off,but sacl not null, sacl will be in binary form or sddl form
;owner, group, dacl and sacl are request
true
false
4
BA
BG
64:2:4096:BA:false:0
0:1:4096:BO:false:0
true
true
true
true
O:BAG:BGD:(D;;0x1000;;;BO)S:(AU;SA;0x1000;;;BA)

[TestCase]
;sacl present flag off, sacl is null, sacl will not be in binary form or sddl form
;owner, group, dacl and sacl are request
true
false
4
BA
BG
null
0:1:4096:BO:false:0
true
true
true
true
O:BAG:BGD:(D;;0x1000;;;BO)

[TestCase]
;sacl present flag on, sacl is null, sacl will not be in binary form and sddl form
;owner, group, dacl and sacl are request
true
false
20
BA
BG
null
0:1:4096:BO:false:0
true
true
true
true
O:BAG:BGD:(D;;0x1000;;;BO)


;*************************************************************************************************
;3 cases for dacl and dacl present flag combination, 
[TestCase]
;dacl present flag off,but dacl not null, dacl will be in binary form and sddl form
;owner, group, dacl and sacl are request
true
false
16
BA
BG
64:2:4096:BA:false:0
0:1:4096:BO:false:0
true
true
true
true
O:BAG:BGD:(D;;0x1000;;;BO)S:(AU;SA;0x1000;;;BA)

[TestCase]
;dacl present flag off, dacl is null, dacl with one ace will be created after final null Dacl fix, but not show in sddl form
;owner, group, dacl and sacl are request
true
false
16
BA
BG
64:2:4096:BA:false:0
null
true
true
true
true
O:BAG:BGS:(AU;SA;0x1000;;;BA)

[TestCase]
;dacl present flag on, dacl is null, dacl with one ace will be created after final null Dacl fix, but not show in sddl form
;owner, group, dacl and sacl are request
true
false
20
BA
BG
64:2:4096:BA:false:0
null
true
true
true
true
O:BAG:BGS:(AU;SA;0x1000;;;BA)

;*************************************************************************************************
;2 cases for null owner, null group
[TestCase]
;null owner
;owner, group, dacl and sacl are request
true
false
20
null
BG
64:2:4096:BA:false:0
0:1:4096:BO:false:0
true
true
true
true
G:BGD:(D;;0x1000;;;BO)S:(AU;SA;0x1000;;;BA)


[TestCase]
;null group
;owner, group, dacl and sacl are request
true
false
20
BA
null
64:2:4096:BA:false:0
0:1:4096:BO:false:0
true
true
true
true
O:BAD:(D;;0x1000;;;BO)S:(AU;SA;0x1000;;;BA)

