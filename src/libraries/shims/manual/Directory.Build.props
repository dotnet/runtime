<Project>
  <PropertyGroup>
    <!-- ensure these projects use a different intermediate and output directory than generated projects -->
    <OutDirName>manual.$(MSBuildProjectName)</OutDirName>
  </PropertyGroup>

  <Import Project="..\Directory.Build.props" />

  <!-- import generated projects in order to share generated properties -->
  <Import Project="..\generated\$(MSBuildProjectName).csproj" />

  <PropertyGroup>
    <IsRuntimeAssembly>true</IsRuntimeAssembly>
    <BaseIntermediateOutputPath>$([MSBuild]::NormalizeDirectory('$(ArtifactsObjDir)', '$(OutDirName)'))</BaseIntermediateOutputPath>
    <IntermediateOutputPath>$(BaseIntermediateOutputPath)$(TargetFramework)-$(Configuration)</IntermediateOutputPath>
    <!-- Use runtime assemblies for the TargetFramework, using TargetOS -->
    <ShimRefPath>$(ArtifactsBinDir)runtime/$(BuildTargetFramework)-$(TargetOS)-$(Configuration)-$(TargetArchitecture)/</ShimRefPath>
    <CoreCLRTargetOS>$(TargetOS)</CoreCLRTargetOS>
    <MonoTargetOS>$(TargetOS)</MonoTargetOS>
    <TargetFrameworks>$(NetCoreAppCurrent)</TargetFrameworks>
  </PropertyGroup>

  <ItemGroup>
    <ReferencePath
      Include="$(ShimRefPath)System.*.dll;$(ShimRefPath)Microsoft.Win32.*.dll;$(ShimRefPath)netstandard.dll"
      Exclude="$(ShimRefPath)$(MSBuildProjectName).dll" />
  </ItemGroup>

  <Target Name="AddSystemPrivateCoreLibReferencePath" DependsOnTargets="GetFilesFromRuntime" BeforeTargets="ResolveReferences">
    <ItemGroup>
      <ReferencePath Include="@(RuntimeFiles)" Condition="'%(FileName)%(Extension)' == 'System.Private.CoreLib.dll'" />
    </ItemGroup>
  </Target>
</Project>
