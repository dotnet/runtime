<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <TargetFrameworks>$(NetCoreAppCurrent)-windows;$(NetCoreAppCurrent);$(NetCoreAppMinimum)-windows;$(NetCoreAppMinimum);netstandard2.0;$(NetFrameworkMinimum)</TargetFrameworks>
    <AllowUnsafeBlocks>true</AllowUnsafeBlocks>
    <Nullable>enable</Nullable>
    <!-- Supress CA2249: Consider using String.Contains instead of String.IndexOf to avoid ifdefs. -->
    <NoWarn>$(NoWarn);CA2249</NoWarn>
    <!-- Suppress SYSLIB0004: 'RuntimeHelpers.PrepareConstrainedRegions()' is obsolete to avoid ifdefs. -->
    <NoWarn>$(NoWarn);SYSLIB0004</NoWarn>
    <!-- Suppress CA1845: Use span-based 'string.Concat' and 'AsSpan' instead of 'Substring' to avoid ifdefs. -->
    <NoWarn>$(NoWarn);CA1845</NoWarn>
    <IsPackable>true</IsPackable>
    <PackageDescription>Provides a collection of classes for OLEDB.

Commonly Used Types:
System.Data.OleDb.OleDbCommand
System.Data.OleDb.OleDbCommandBuilder
System.Data.OleDb.OleDbConnection
System.Data.OleDb.OleDbDataAdapter
System.Data.OleDb.OleDbDataReader
System.Data.OleDb.OleDbParameter
System.Data.OleDb.OleDbParameterCollection
System.Data.OleDb.OleDbTransaction</PackageDescription>
  </PropertyGroup>

  <!-- DesignTimeBuild requires all the TargetFramework Derived Properties to not be present in the first property group. -->
  <PropertyGroup>
    <TargetPlatformIdentifier>$([MSBuild]::GetTargetPlatformIdentifier('$(TargetFramework)'))</TargetPlatformIdentifier>
    <IsPartialFacadeAssembly Condition="$([MSBuild]::GetTargetFrameworkIdentifier('$(TargetFramework)')) == '.NETFramework'">true</IsPartialFacadeAssembly>
    <GeneratePlatformNotSupportedAssemblyMessage Condition="'$(IsPartialFacadeAssembly)' != 'true' and '$(TargetPlatformIdentifier)' != 'windows'">SR.PlatformNotSupported_OleDb</GeneratePlatformNotSupportedAssemblyMessage>
    <NoWarn Condition="'$(GeneratePlatformNotSupportedAssemblyMessage)' != ''">$(NoWarn);CS0618</NoWarn>
    <EnableDefaultCompileItems Condition="'$(TargetPlatformIdentifier)' != 'windows'">false</EnableDefaultCompileItems>
  </PropertyGroup>

  <ItemGroup Condition="'$(TargetPlatformIdentifier)' == 'windows'">
    <Compile Include="$(CommonPath)Interop\Windows\Interop.Libraries.cs"
             Link="Common\Interop\Windows\Interop.Libraries.cs" />
    <Compile Include="$(CommonPath)Interop\Windows\Kernel32\Interop.GetUserDefaultLCID.cs"
             Link="Common\Interop\Windows\Kernel32\Interop.GetUserDefaultLCID.cs" />
    <Compile Include="$(CommonPath)Interop\Windows\Kernel32\Interop.GetCurrentProcessId.cs"
             Link="Common\Interop\Windows\Kernel32\Interop.GetCurrentProcessId.cs" />
    <Compile Include="$(CommonPath)Interop\Windows\Kernel32\Interop.LocalAlloc.cs"
             Link="Common\Interop\Windows\Kernel32\Interop.LocalAlloc.cs" />
    <Compile Include="$(CommonPath)Interop\Windows\OleAut32\Interop.SysAllocStringLen.cs"
             Link="Common\Interop\Windows\OleAut32\Interop.SysAllocStringLen.cs" />
    <Compile Include="$(CommonPath)Interop\Windows\OleAut32\Interop.SetErrorInfo.cs"
             Link="Common\Interop\Windows\OleAut32\Interop.SetErrorInfo.cs" />
    <Compile Include="$(CommonPath)Interop\Windows\OleAut32\Interop.SysFreeString.cs"
             Link="Common\Interop\Windows\OleAut32\Interop.SysFreeString.cs" />
    <Compile Include="$(CommonPath)Interop\Windows\OleAut32\Interop.VariantClear.cs"
             Link="Common\Interop\Windows\OleAut32\Interop.VariantClear.cs" />
    <Compile Include="$(CommonPath)Interop\Windows\Ole32\Interop.CoTaskMemAlloc.cs"
             Link="Common\Interop\Windows\Ole32\Interop.CoTaskMemAlloc.cs" />
    <Compile Include="$(CommonPath)Interop\Windows\Ole32\Interop.PropVariantClear.cs"
             Link="Common\Interop\Windows\Ole32\Interop.PropVariantClear.cs" />
    <Compile Include="$(CommonPath)System\Data\Common\MultipartIdentifier.cs"
             Link="Common\System\Data\Common\MultipartIdentifier.cs" />
  </ItemGroup>

  <ItemGroup Condition="'$(TargetPlatformIdentifier)' != 'windows'">
    <Compile Remove="UnsafeNativeMethods.COMWrappers.cs" />
    <Compile Remove="OleDbComWrappers.cs" />
  </ItemGroup>

  <ItemGroup>
    <EmbeddedResource Include="Resources\System.Data.OleDb.OleDbMetaData.xml"
                      LogicalName="System.Data.OleDb.OleDbMetaData.xml" />
  </ItemGroup>

  <ItemGroup Condition="'$(TargetFrameworkIdentifier)' == '.NETCoreApp'">
    <ProjectReference Include="$(LibrariesProjectRoot)System.Configuration.ConfigurationManager\src\System.Configuration.ConfigurationManager.csproj" />
    <ProjectReference Include="$(LibrariesProjectRoot)System.Diagnostics.PerformanceCounter\src\System.Diagnostics.PerformanceCounter.csproj" />
  </ItemGroup>
</Project>
